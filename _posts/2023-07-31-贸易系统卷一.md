---
layout: single
title: NCU日志1 - 贸易概述I 全球贸易基础
mathjax: true
date: 2023-08-26
categories:
  - cu
tags:
  - paradox
  - eu4
  - modding
---
> 本篇日志由 @SemiObsever 修订

## 原版贸易

> 这是一方缺失拼片的拼图

在原版的贸易系统框架下，玩家只需要在一些交易节点布置商人和商船，就可以获得大量贸易收入，而无需考虑物资流动、市场需求等因素。

此外，贸易系统在游戏中的影响被过度夸大了。历史上贸易确实对国家实力的发展产生了重要影响，但在游戏的中后期，贸易常常成为玩家最主要的收入来源，生产与税收（尤其是税收）的表现低到了不合理的境地。

除此之外，原版系统莫名其妙的锁定了贸易流向，三个“贸易黑洞”均处于欧洲。这种欧洲中心论的做法极大的伤害了游戏的策略性与合理性。

可惜的是，老版cu对原版不合理贸易系统的修改几乎为0。这一缺憾将由新版cu填补。

## 新的火星贸易系统
本日志描述了通过供需与价格调节商品流通方向的新贸易系统（该系统为了兼顾可玩性与运行速度进行了一定的简化）

## 从贸易区开始

> 参与贸易的基本单位：

“**贸易省(trade state)**”由一个国家在该贸易区中的所有省份(province)组成。一个节点中有来自多个国家的贸易省，一个国家也在不同的节点拥有多个贸易省。它同时可以是出口方和进口方。

例：

大明占有了英吉利海峡贸易区的伦敦和阿姆斯特丹，则大明会自动在英吉利海峡获得一个**贸易省**(由阿姆斯特丹和伦敦这两个省份组成)

<!-- 8.25 -->

## 进出口难题

> 新系统中进出口的运作逻辑并不复杂。
> 目的：构造由多个进口贸易省(“**进口省**”)与多个出口贸易省（“**出口省**”）组成的交易体系。

**出口省**的总出口上限只与该省所包含的省份总产出有关。他们会优先选择提供较高**进口报价**的**进口省**进行出口，并且在每次出口中都试图出口尽可能多的货物。

而一个**进口省**会按该省所在贸易区中各国的贸易竞争力依次向各国的**出口省**发起进口，而同一国家的多个**出口省**则根据其总商业发展度顺序依次出口。

对某**进口省**的出口上限为

$$
进口省需求剩余量 \times \frac{出口省贸易竞争力}{剩余贸易竞争力}
$$

即，剩余未利用的进口需求会重新加入分配。

示例：
假设丹麦在吕贝克对牲畜的需求为20，收购价为5，各参数如下表所示。

<table>
    <tr><td>省名</td><td>节点位置</td><td>国别</td><td>竞争力</td><td>商业发展</td><td>产出</td><td>生产成本</td><td>贸易成本</td>
    </tr>
    <tr><td>A</td><td>北海</td><td rowspan="2">英国</td><td rowspan="2">50%</td><td>50</td><td>3.4</td><td>4.2</td><td>0.6</td>
    </tr>
    <tr><td>B</td><td>英吉利</td><td>200</td><td>8.1</td><td>4</td><td>0.4</td>
    </tr>
    <tr><td>C</td><td>英吉利</td><td>荷兰</td><td>20%</td><td>80</td><td>6</td><td>3.8</td><td>0.3</td>
    </tr>
    <tr><td>D</td><td>吕贝克</td><td>丹麦</td><td>30%</td><td>60</td><td>3</td><td>4.4</td><td>0.1</td>
    </tr>
</table>

若丹麦D为该体系中唯一的进口省，则丹麦D的进口顺序为：

1. 英国B；
2. 英国A；
3. 丹麦D；
4. 荷兰C。

step 1:B，A先后对D出口，出口总量不超过D需求的50％。该额度优先给B分配40%，剩余10%分配给A，占满出口份额。剩余1-50％=50％的市场容量中，D对D的最大出口份额为

$$
50％ \cdot\frac{30％}{1-50％}=30％
$$

step 2: D实际出口15%，未占满出口份额。剩余50％-15％=35%的市场容量中，C对D的最大出口份额为

$$
35％ \cdot\frac{20％}{1-50％-30％}=35％
$$

step 3:C实际出口30％D的需求,则D的总需求被满足了95％，缺口为5％。由此我们得到最终收益如下表
<table>
    <tr><td>省名</td><td>市占率</td><td>出口量</td><td>出口价</td><td>销售额</td><td>总成本</td><td>利润</td>
    </tr>
    <tr><td>A</td><td>10%</td><td>2</td><td>4.4</td><td>8.8</td><td>14.28</td><td>-5.48</td>
    </tr>
    <tr><td>B</td><td>40%</td><td>8</td><td>4.6</td><td>36.8</td><td>32.4</td><td>4.4</td>
    </tr>
    <tr><td>C</td><td>30%</td><td>6</td><td>4.7</td><td>28.2</td><td>22.8</td><td>5.4</td>
    </tr>
    <tr><td>D</td><td>15%</td><td>3</td><td>4.9</td><td>14.7</td><td>13.2</td><td>1.5</td>
    </tr>
    <tr><td>缺口</td><td>5%</td><td>1</td>
    </tr>
</table>

```
出口价 = 进口价 - 贸易成本
销售额 = 出口量 × 出口价
总成本 = 生产成本 × 生产量
利润 = 销售额 - 总成本
```

## 进口报价

> 报价系统非常直观，直接与供需系统挂钩。

最初的出口报价由模拟程序生成以保持游戏开局时大体的稳定，之后将由游戏内系统每年计算生成。在**进口省**的**进口报价**生成后，所有**出口省**都会尝试出口完全满足需求数量的商品。如果此时的总商品数量大于该**进口省**需求量，下次结算中该省份就会下调自己的**进口报价**；反之(如前例95％<1)，**进口报价**就会增加。

调价的速度的速度与当地该类商品的缺乏/饱和比例成平方关系(如前例$$(5％)^2$$)，不过每次调价的幅度不会大于$$\pm 20％$$且**基础价格 × 0.1**$$\leq$$**进口报价**$$\leq$$**基础价格 × 10**。

不过报价系统并没有在这里结束，各个**出口省**拿到的报价并不和**进口省**提供的**进口报价**完全一样。他们实际报价将受到**距离**、**出口关税**等因素的影响，然后他们会根据修正后的报价来决定优先向哪些**贸易省**出口自己的货物。

示例：

这么简单的系统就不需要示例了！

## 结尾
本篇日志只是贸易系统的试水，其中数值、机制与概念可能和实际版本有所出入。另外受制于篇幅和精力，该篇日志只阐述了贸易系统的一些基础性框架，剩余的产业、关税等系统将会在之后进行进一步描述。
